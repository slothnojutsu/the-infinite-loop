<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - ParKing</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">

</head>
<body>
    <header>
        <h1>Welcome to ParKing<img src="crown2.png" alt="Logo" class="header-image"></h1>

        <p></p> <!--empty line, so they are not too close to one another-->

        <div class="content-wrapper">
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="zip.html">Availability</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="login.html">Sign In</a></li>
                    <li><a href="#" onclick="handlePayClick()">Pay</a></li>
                </ul>
            </nav>
        </div>

    </header>

    <div id="container">
        <section id="user-info">
            <h3>Personal Information</h3>
            <!-- added id here so it takes info from register
            and puts it in the name and email section-->
            <p><strong>Name:</strong> <span id="full-name"></span></p>
            <p><strong>Email:</strong> <span id="email"></span></p>
            <p><strong>Phone:</strong> <span id="pnum"></span></p>
        </section>

        <section id="license-plate">
            <h3>Vehicle Information</h3>
            <p><strong>License Plate:</strong> <span id="lpnum"></span></p>
        </section>

        <section id="reservation-info">
            <h3>Your Reservation</h3>
            <p><strong>Date:</strong> <span id="res-date">N/A</span></p>
            <p><strong>Time:</strong> <span id="res-time">N/A</span></p>
            <p><strong>Location:</strong> <span id="res-location">N/A</span></p>
        </section>
        
        <!--puts the info from the register page into the 
        name and email part of the page-->
        <script>
            const name = localStorage.getItem('full-name');
            const email = localStorage.getItem('email');
            const phone = localStorage.getItem('pnum'); 
            const plate = localStorage.getItem('lpnum');
            
            document.getElementById('full-name').textContent = name;
            document.getElementById('email').textContent = email;
            document.getElementById('pnum').textContent = phone;
            document.getElementById('lpnum').textContent = plate;
        </script>

<section id="settings">
    <h3>Account Settings</h3>

    <button onclick="showChangePassword()">Change Password</button>
    <div id="password-section" style="display: none;">
        <input type="password" id="new-password" placeholder="Enter new password">
        <button onclick="savePassword()">Save</button>
    </div>

    <button onclick="showUpdateEmail()">Update Email</button>
    <div id="email-section" style="display: none;">
        <input type="email" id="new-email" placeholder="Enter new email">
        <button onclick="saveEmail()">Save</button>
    </div>

    <button onclick="showVehicle()">Change Vehicle</button>
    <div id="vehicle-section" style="display: none;">
        <input type="text" id="new-plate" placeholder="Enter new license plate">
        <button onclick="saveVehicle()">Save</button>
    </div>
</section>

<section id="logout">
    <button onclick="logout()">Logout</button>
</section>

    </div>

    <script>
        function editSection(sectionId) {
          const section = document.getElementById(sectionId);
          const spans = section.querySelectorAll('span');
        
          spans.forEach(span => {
            const currentValue = span.textContent;
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.id = span.id + '-input';
        
            span.style.display = 'none';
            span.parentElement.appendChild(input);
          });
        
          const saveBtn = document.createElement('button');
          saveBtn.textContent = 'Save';
          saveBtn.onclick = function () {
            spans.forEach(span => {
              const input = document.getElementById(span.id + '-input');
              const newValue = input.value;
              localStorage.setItem(span.id, newValue);
              span.textContent = newValue;
              span.style.display = 'inline';
              input.remove();
            });
            saveBtn.remove();
          };
        
          section.appendChild(saveBtn);
        }
        
        const latestReservation = JSON.parse(localStorage.getItem("latest-reservation"));
        if (latestReservation) {
            document.getElementById("res-area").textContent = latestReservation.area;
            document.getElementById("res-time").textContent = latestReservation.time;
        }

        // On page load: fill from localStorage
        window.onload = function () {
          ['full-name', 'email', 'pnum', 'lpnum'].forEach(id => {
            const saved = localStorage.getItem(id);
            if (saved) {
              const el = document.getElementById(id);
              if (el) el.textContent = saved;
            }
          });
        };
        
        function logout() {
            // Clear localStorage to log the user out
            localStorage.clear();

            // Redirect to the login page
            window.location.href = "login.html";
        }

        function handlePayClick() {
            
            const userData = localStorage.getItem('email');
    
            if (userData) {
                window.location.href = 'payment.html';
            } else {
                window.location.href = 'guest.html';
            }
        }
    </script>
        </script>
        
    <p></p> <!--empty line, so they are not too close to one another-->

    <footer>
        <h4>Why Choose ParKing?</h4>
        <p>ParKing helps you quickly locate parking spaces in your area. Whether you're at work, shopping, or at a concert, finding a spot has never been easier!</p>
        <p>Our system provides real-time updates on available spaces, ensuring you never waste time circling the block again.</p></p>
        
        <h5>&copy; 2025 ParKing. All rights reserved.</h5>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('res-date').textContent = localStorage.getItem('reservation-date') || 'Not reserved';
            document.getElementById('res-time').textContent = localStorage.getItem('parking-time') || 'Not reserved';
            document.getElementById('res-location').textContent = localStorage.getItem('parking-area') || 'Not reserved';
        });
        </script>

    <script>
        // Check if the user is NOT logged in
        if (localStorage.getItem('loggedIn') !== 'true') {
            // If not logged in, redirect to the login page
            alert("You are not logged in.");
            window.location.href = "login.html"; // Redirect to login page
        }
    </script>
</body>
</html>
